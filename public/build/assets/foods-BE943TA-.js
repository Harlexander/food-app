import{r as h,j as e,H as U,L as $,a as F}from"./app-9jDHsoem.js";import{C as I,a as R,d as X,c as L}from"./card-BlUUs8w7.js";import{B as k}from"./badge-DM15g0ga.js";import{a as O,B as p}from"./createLucideIcon-BsU7lWfN.js";import{A as J,C as K}from"./app-layout-CKGevSQF.js";import{d as G}from"./index-CGhS-bFO.js";import{S as A,a as E,b as T,c as P,d as N}from"./select-BTbO5SUe.js";import{D as B,a as H,b as M,c as V,d as Q,e as W}from"./dialog-QchkNYlu.js";import{I as w}from"./input-CT8XZ4KV.js";import{L as g,I as y}from"./label-BNAZkbAD.js";import{C as Y}from"./checkbox-aMNmINYP.js";import{P as q,T as Z}from"./trash-2-DCm1MOLD.js";import{F as ee}from"./filter-DO1jgCPc.js";import{C as se}from"./circle-check-big-ouNJZ7GA.js";/* empty css            */import"./index-mrT4lkJz.js";import"./index-BnAWAh7z.js";import"./index-DEsIzduE.js";import"./index-CiiBO1pW.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],te=O("CircleX",ae);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],ie=O("Trash",re);function le({open:u,onOpenChange:f,food:i,categories:b,onSuccess:D}){const[n,j]=h.useState({name:"",description:"",image:"",category:"",is_active:!0,sort_order:0,portion_sizes:[]}),[c,m]=h.useState({}),[t,x]=h.useState(!1);h.useEffect(()=>{i&&u?(j({name:i.name||"",description:i.description||"",image:i.image||"",category:i.category||"",is_active:i.is_active??!0,sort_order:i.sort_order||0,portion_sizes:i.portion_sizes.map(a=>({id:a.id,size_name:a.size_name,price:a.price,sort_order:0}))||[]}),m({}),x(!1)):u||(m({}),x(!1))},[i,u]);const C=async a=>{if(a.preventDefault(),!!i){m({}),x(!0);try{const r=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",l=await fetch(`/dashboard/foods/${i.id}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":r,Accept:"application/json"},body:JSON.stringify(n)}),s=await l.json();if(!l.ok){if(s.errors){const d={};Object.keys(s.errors).forEach(v=>{d[v]=Array.isArray(s.errors[v])?s.errors[v][0]:s.errors[v]}),m(d)}else m({general:s.message||"Failed to update food. Please try again."});x(!1);return}D(),f(!1)}catch{m({general:"An error occurred. Please try again."}),x(!1)}}},o=(a,r)=>{j(l=>({...l,[a]:r})),c[a]&&m(l=>{const s={...l};return delete s[a],s})},_=()=>{j(a=>({...a,portion_sizes:[...a.portion_sizes,{size_name:"",price:0,sort_order:a.portion_sizes.length}]}))},S=a=>{j(r=>({...r,portion_sizes:r.portion_sizes.filter((l,s)=>s!==a)}))},z=(a,r,l)=>{j(s=>({...s,portion_sizes:s.portion_sizes.map((d,v)=>v===a?{...d,[r]:l}:d)}))};return i?e.jsx(B,{open:u,onOpenChange:f,children:e.jsxs(H,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(M,{children:e.jsx(V,{className:"text-2xl font-bold",children:"Edit Food"})}),e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[c.general&&e.jsx("div",{className:"rounded-md bg-red-50 p-4 text-red-800 text-sm",children:c.general}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"name",children:"Food Name *"}),e.jsx(w,{id:"name",value:n.name,onChange:a=>o("name",a.target.value),required:!0,disabled:t}),e.jsx(y,{message:c.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"category",children:"Category *"}),e.jsxs(A,{value:n.category,onValueChange:a=>o("category",a),children:[e.jsx(E,{id:"category",disabled:t,children:e.jsx(T,{})}),e.jsx(P,{children:b.map(a=>e.jsx(N,{value:a,children:a},a))})]}),e.jsx(y,{message:c.category})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"description",children:"Description"}),e.jsx("textarea",{id:"description",rows:3,value:n.description,onChange:a=>o("description",a.target.value),className:"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-xs placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50",disabled:t}),e.jsx(y,{message:c.description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"image",children:"Image URL"}),e.jsx(w,{id:"image",type:"text",value:n.image,onChange:a=>o("image",a.target.value),placeholder:"/food/example.png",disabled:t}),e.jsx(y,{message:c.image})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"sort_order",children:"Sort Order"}),e.jsx(w,{id:"sort_order",type:"number",value:n.sort_order,onChange:a=>o("sort_order",parseInt(a.target.value)||0),min:"0",disabled:t}),e.jsx(y,{message:c.sort_order})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-8",children:[e.jsx(Y,{id:"is_active",checked:n.is_active,onCheckedChange:a=>o("is_active",a),disabled:t}),e.jsx(g,{htmlFor:"is_active",className:"cursor-pointer",children:"Active (visible to customers)"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Portion Sizes"}),e.jsxs(p,{type:"button",variant:"outline",size:"sm",onClick:_,disabled:t,className:"gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Add Size"]})]}),e.jsx("div",{className:"space-y-3",children:n.portion_sizes.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:'No portion sizes. Click "Add Size" to add one.'}):n.portion_sizes.map((a,r)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(g,{className:"text-xs",children:"Size Name"}),e.jsx(w,{value:a.size_name,onChange:l=>z(r,"size_name",l.target.value),placeholder:"e.g., Large Cooler",disabled:t,required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(g,{className:"text-xs",children:"Price ($)"}),e.jsx(w,{type:"number",step:"0.01",min:"0",value:a.price,onChange:l=>z(r,"price",parseFloat(l.target.value)||0),placeholder:"0.00",disabled:t,required:!0})]})]}),e.jsx(p,{type:"button",variant:"outline",size:"icon",onClick:()=>S(r),disabled:t,className:"text-red-600 hover:text-red-700",children:e.jsx(Z,{className:"h-4 w-4"})})]},r))}),c.portion_sizes&&e.jsx(y,{message:c.portion_sizes})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>f(!1),disabled:t,className:"flex-1",children:"Cancel"}),e.jsx(p,{type:"submit",disabled:t||n.portion_sizes.length===0,className:"flex-1 bg-green-500 text-white hover:bg-green-600",children:t?"Updating...":"Update Food"})]})]})]})}):null}const ne=[{title:"Dashboard",href:G().url},{title:"Foods",href:"/dashboard/foods"}];function ze({foods:u,categories:f,counts:i,filters:b}){const[D,n]=h.useState(!1),[j,c]=h.useState(null),[m,t]=h.useState(!1),[x,C]=h.useState(null),[o,_]=h.useState(!1),S=(s,d)=>{F.get("/dashboard/foods",{...b,[s]:d},{preserveState:!0,replace:!0})},z=s=>{c(s),n(!0)},a=()=>{F.reload({only:["foods","counts"]})},r=s=>{C(s),t(!0)},l=()=>{x&&(_(!0),F.delete(`/dashboard/foods/${x.id}`,{onSuccess:()=>{t(!1),C(null),_(!1)},onError:()=>{_(!1)}}))};return e.jsxs(J,{breadcrumbs:ne,children:[e.jsx(U,{title:"Foods Management"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"sm:text-3xl text-2xl font-bold",children:"Foods Management"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage your food inventory and menu items"})]}),e.jsx($,{href:"/dashboard/foods/create",children:e.jsxs(p,{className:"gap-2 bg-primary text-white hover:bg-primary/80",children:[e.jsx(q,{className:"h-4 w-4"}),"Add Food"]})})]}),e.jsxs(I,{className:"border-0 shadow-sm",children:[e.jsx(R,{children:e.jsxs(X,{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary rounded p-2",children:e.jsx(ee,{className:"h-5 w-5"})}),"Filters"]})}),e.jsx(L,{children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Category"}),e.jsxs(A,{value:b.category,onValueChange:s=>S("category",s),children:[e.jsx(E,{children:e.jsx(T,{})}),e.jsxs(P,{children:[e.jsx(N,{value:"all",children:"All Categories"}),f.map(s=>e.jsx(N,{value:s,children:s},s))]})]})]}),e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Status"}),e.jsxs(A,{value:b.status,onValueChange:s=>S("status",s),children:[e.jsx(E,{children:e.jsx(T,{})}),e.jsxs(P,{children:[e.jsx(N,{value:"all",children:"All Status"}),e.jsxs(N,{value:"active",children:["Active (",i.active,")"]}),e.jsxs(N,{value:"inactive",children:["Inactive (",i.inactive,")"]})]})]})]})]})})]}),e.jsx(I,{className:"border-0 shadow-sm",children:e.jsx(L,{className:"p-0",children:u.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(K,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-500",children:"No foods found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Portion Sizes"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:s.image||"",alt:s.name,className:"w-10 h-10 object-cover rounded-md"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:s.name})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(k,{variant:"outline",children:s.category})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:s.portion_sizes.length>0?s.portion_sizes.map(d=>e.jsx(k,{variant:"outline",className:"text-xs",children:d.size_name},d.id)):e.jsx("span",{className:"text-sm text-gray-400",children:"-"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.is_active?e.jsxs(k,{className:"bg-green-100 text-green-700 border-0 flex items-center gap-1",children:[e.jsx(se,{className:"h-3 w-3"}),"Active"]}):e.jsxs(k,{className:"bg-gray-100 text-gray-600 border-0 flex items-center gap-1",children:[e.jsx(te,{className:"h-3 w-3"}),"Inactive"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(p,{variant:"outline",size:"sm",onClick:()=>z(s),children:"Edit"}),e.jsx(p,{variant:"destructive",size:"sm",onClick:()=>r(s),children:e.jsx(ie,{className:"h-4 w-4"})})]})})]},s.id))})]})})})}),e.jsx(le,{open:D,onOpenChange:n,food:j,categories:f,onSuccess:a}),e.jsx(B,{open:m,onOpenChange:t,children:e.jsxs(H,{children:[e.jsxs(M,{children:[e.jsx(V,{children:"Delete Food"}),e.jsxs(Q,{children:["Are you sure you want to delete ",e.jsx("strong",{children:x?.name}),"? This action cannot be undone and will permanently delete the food item and all its portion sizes."]})]}),e.jsxs(W,{children:[e.jsx(p,{variant:"outline",onClick:()=>{t(!1),C(null)},disabled:o,children:"Cancel"}),e.jsx(p,{variant:"destructive",onClick:l,disabled:o,children:o?"Deleting...":"Delete"})]})]})})]})]})}export{ze as default};
